<div class="hero-photo"
     style="background-image: url(https://images.unsplash.com/photo-1608613304899-ea8098577e38?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1287&q=80)">
     <div class="opacity-70 absolute w-full  h-80 md:h-128" style="background-image: url(/img/vzorec-test.png); background-position:right; background-repeat:no-repeat">
     </div>
    </div>
<div id="content">
  <div class="font-light text-left text-base leading-relaxed w-full">
    <h1 class="text-2xl md:text-3xl font-light font-Noto tracking-wider uppercase my-8">{{ page:title }}</h1>
    {{content}}
  </div>
</div>
<div id="content">
  <!-- This example requires Tailwind CSS v2.0+ -->
  {{collection:jobs}}
    <div x-data="{ expanded: null }" class="mb-24">
        <div class="grid grid-cols-1 sm:grid-cols-3 divide-x divide-banana-500">
            <div class="text-xl md:text-2xl pr-8 text-banana-500 text-left md:text-right uppercase mb-8 md:mb-0">{{title}}</div>
            <div class="col-span-2 pl-8">
                {{content | strip_tags:p}}
                <a @click="expanded = expanded !== {{index}} ? {{index}} : null"
                class="flex items-center text-banana-500 text-right text-base cursor-pointer">{{trans:trans.prijava}} <i class="ml-2 fa-solid fa-arrow-right"></i></a>
            </div>
        </div>

        <div x-show="expanded === {{index}}" x-collapse.duration.500ms x-cloak>
            <div  class="mt-12 max-w-4xl mx-auto">
                {{ if {session:has key="errors"} }}
                <p class="p-4 bg-red-100 text-red-800 rounded shadow-sm mb-5 text-sm">{{trans:trans.error}}</p>
                {{ /if }}
                {{ if {session:has key="success"} }}
                <p class="p-4 bg-green-100 text-green-800 rounded shadow-sm mb-5 text-sm">{{trans:trans.sucsess}}</p>
                {{ /if }}
                <h2 class="text-2xl md:text-3xl font-light sm:text-2xl uppercase">{{trans:trans.prijava}}</span></h2>
                <p class="mt-4 text-base font-light text-gray-300 sm:mt-3">{{trans:trans.prijava_tekst}}
                    <ul class="text-base font-light text-gray-300 ">
                        <li>{{trans:trans.prijava_1}}</li>
                        <li>{{trans:trans.prijava_2}}</li>
                    </ul>
                    </p>
                <form action="/job/{{ id }}" enctype="multipart/form-data"
                      method="POST"
                      class="mt-9 grid grid-cols-1 gap-y-6 sm:grid-cols-2 sm:gap-x-8">
                      {{ csrf_field }}
                      <input type="hidden" name="subject" value="{{ title }}" />
                  <div>
                    <label for="first-name"
                           class="block text-sm font-medium text-gray-300">{{trans:trans.ime}} *</label>
                    <div class="mt-1">
                      <input type="text"
                             name="first-name"
                             id="first-name"
                             required
                             autocomplete="given-name"
                             class="block w-full bg-transparent shadow-sm sm:text-sm focus:ring-banana-500 focus:border-banana-500 border-gray-600 rounded-md">
                    </div>
                  </div>
                  <div>
                    <label for="last-name"
                           class="block text-sm font-medium text-gray-300">{{trans:trans.priimek}} *</label>
                    <div class="mt-1">
                      <input type="text"
                             name="last-name"
                             id="last-name"
                             required
                             autocomplete="family-name"
                             class="block w-full bg-transparent shadow-sm sm:text-sm focus:ring-banana-500 focus:border-banana-500 border-gray-600 rounded-md">
                    </div>
                  </div>
                  <div class="flex flex-col space-y-6 col-span-1">
                    <div>
                        <label for="email"
                               class="block text-sm font-medium text-gray-300">Email *</label>
                        <div class="mt-1">
                          <input id="email"
                                 name="email"
                                 type="email"
                                 required
                                 autocomplete="email"
                                 class="block w-full bg-transparent shadow-sm sm:text-sm focus:ring-banana-500 focus:border-banana-500 border-gray-600 rounded-md">
                        </div>
                    </div>
                    <div>
                        <label for="phone" class="block text-sm font-medium text-gray-300">{{trans:trans.telefon}} *</label>
                        <div class="mt-1">
                          <input type="text"
                                required
                                 name="phone"
                                 id="phone"
                                 autocomplete="tel"
                                 aria-describedby="phone-description"
                                 class="block w-full bg-transparent shadow-sm sm:text-sm focus:ring-banana-500 focus:border-banana-500 border-gray-600 rounded-md">
                        </div>
                    </div>
                </div>

                  <div class="sm:col-span-1" x-data="files()">
                    <div class="sm:col-span-2 h-full">
                        <div :class="dragging ? 'border-gray-300' : 'border-gray-600'" class="flex justify-center rounded-md border border-dashed px-6 p-2 h-full items-center relative" x-on:dragleave="dragging = false" x-on:dragover.prevent="dragging = true" x-on:dragstart.prevent="dragging = true" x-on:drop.prevent="drop($event.dataTransfer.files)">
                          <div class="text-center">
                            <div class="space-y-1" x-show="!files.length">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="mx-auto h-8 w-8 text-gray-300">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.112 2.13" /></svg>
                                <div class="flex text-sm text-center text-gray-600">
                                  <label for="file-input" class="relative cursor-pointer rounded-md font-medium text-banana-500 focus-within:outline-none" x-on:>
                                    <span>{{trans:trans.naloži}} </span>
                                    <input required id="file-input" name="file-input[]" type="file" accept=".pdf" class="sr-only" x-on:change="drop($event.target.files)" multiple>
                                  </label>
                                  <div class="pl-1 text-center text-gray-300">{{trans:trans.naloži_2}}</div>
                                </div>
                                <span class="text-xs text-gray-300 block">{{trans:trans.pdf}}</span>
                            </div>
                            <div class="text-sm text-gray-300" x-show="files.length">
                                <template x-for="file in files">
                                    <div class="block" x-text="file.name"></div>
                                </template>
                                <a class="cursor-pointer" @click="reset()">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 absolute right-2 top-2 text-gray-300">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                      </svg>
                                </a>
                            </div>
                          </div>
                        </div>
                      </div>
                  </div>

                  <div class="text-right sm:col-span-2">
                    <button type="submit"
                            class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-gray-900 bg-banana-500 hover:bg-banana-500 hover:opacity-80 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-banana-500">{{trans:trans.pošlji_prijavo}}</button>
                  </div>
                </form>
            </div>
        </div>
    </div>
  {{/collection:jobs}}
</div>

<script>
  function files() {
      return {
        files: [],
        dragging: false,
        reset() {
            this.files = [];
            document.getElementById("file-input").value = '';
        },
        drop(files) {
            let totalSize = 0;
            Object.values(files).forEach(f => {
                totalSize += f.size / 1024 / 1024;
            });
            if(totalSize > 10) {
                alert('Total size must not exceed 10MB');
                return false;
            }
            this.files = Object.values(files);
            this.dragging = false;
        }
      }
    }
  </script>
